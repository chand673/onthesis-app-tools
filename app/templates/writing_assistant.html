{% extends "layout.html" %}

{% block title %}Asisten AI (PRO) - OnThesis{% endblock %}

{% block page_styles %}
<!-- Pustaka Ikon -->
<script src="https://unpkg.com/lucide@latest"></script>

<style>
    /*
      STYLESHEET YANG DISIMPLIFIKASI
      Hanya gaya yang relevan untuk halaman menu yang disimpan.
      Gaya untuk .io-panel, .io-textarea, dll. telah dihapus karena tidak lagi digunakan di halaman ini.
    */

    /* Animasi notifikasi (disimpan jika Anda ingin menampilkan notifikasi di halaman ini) */
    @keyframes fade-in-out {
      0% { opacity: 0; transform: translateY(-20px); }
      10% { opacity: 1; transform: translateY(0); }
      90% { opacity: 1; transform: translateY(0); }
      100% { opacity: 0; transform: translateY(-20px); }
    }
    .animate-fade-in-out {
      animation: fade-in-out 4s ease-in-out forwards;
    }
</style>
{% endblock %}

{% block content %}
<div class="h-full w-full p-4 sm:p-6 lg:p-8 flex flex-col">

    <!-- VIEW TUNGGAL: PEMILIHAN FITUR -->
    <div id="feature-selection-view" class="flex flex-col h-full">
        <header class="mb-8 flex-shrink-0 text-center animate-fade-in-up">
            <h1 class="text-3xl md:text-4xl font-bold text-primary">Asisten Penulisan AI (PRO)</h1>
            <p class="text-lg text-secondary mt-1">Pilih alat untuk mengakselerasi penulisan skripsi Anda.</p>
            <div id="usage-counter-display" class="hidden mt-4 inline-flex items-center gap-2 bg-purple-900/50 text-purple-300 text-sm font-medium px-3 py-1 rounded-full border border-purple-500/50">
                <i data-lucide="sparkles" class="h-4 w-4"></i>
                <span>Sisa Percobaan PRO: <strong id="assistant-remaining-count">...</strong></span>
            </div>
        </header>

        <!-- Kumpulan Kartu Fitur -->
        <div class="flex-grow grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6 animate-fade-in-up" style="animation-delay: 0.2s;">
            
            <!-- Kartu Fitur: Generator Latar Belakang -->
            <!-- href bisa diubah nanti ke halaman spesifik, misal: href="/assistant/background-generator" -->
            <a href="#" class="feature-card apex-card flex flex-col items-center justify-center text-center">
                <i data-lucide="file-text" class="w-12 h-12 text-accent-cyan mb-4"></i>
                <h3 class="text-xl font-bold text-primary">Generator Latar Belakang</h3>
                <p class="text-secondary mt-2 text-sm">Buat paragraf pendahuluan yang kuat berdasarkan judul skripsi Anda.</p>
            </a>
            
            <!-- Kartu Fitur: Generator Rumusan Masalah -->
            <a href="#" class="feature-card apex-card flex flex-col items-center justify-center text-center">
                <i data-lucide="lightbulb" class="w-12 h-12 text-accent-cyan mb-4"></i>
                <h3 class="text-xl font-bold text-primary">Generator Rumusan Masalah</h3>
                <p class="text-secondary mt-2 text-sm">Identifikasi pertanyaan penelitian yang relevan dari topik Anda.</p>
            </a>
            
            <!-- Kartu Fitur: Generator Kerangka -->
            <a href="#" class="feature-card apex-card flex flex-col items-center justify-center text-center">
                <i data-lucide="list-tree" class="w-12 h-12 text-accent-cyan mb-4"></i>
                <h3 class="text-xl font-bold text-primary">Generator Kerangka</h3>
                <p class="text-secondary mt-2 text-sm">Susun struktur bab dan sub-bab skripsi Anda secara otomatis.</p>
            </a>
            
            <!-- Kartu Fitur: Generator Abstrak -->
            <a href="#" class="feature-card apex-card flex flex-col items-center justify-center text-center">
                <i data-lucide="book-open-check" class="w-12 h-12 text-accent-cyan mb-4"></i>
                <h3 class="text-xl font-bold text-primary">Generator Abstrak</h3>
                <p class="text-secondary mt-2 text-sm">Rangkum keseluruhan isi skripsi Anda menjadi abstrak yang padat.</p>
            </a>

            <!-- Anda bisa menambahkan kartu fitur lainnya di sini -->

        </div>
    </div>
</div>

<!-- Kontainer Notifikasi (opsional, bisa dihapus jika tidak perlu) -->
<div id="notification-container" class="fixed top-5 right-5 z-50 w-full max-w-xs"></div>
{% endblock %}

{% block page_scripts %}
<script>
document.addEventListener('DOMContentLoaded', () => {
    /*
      SKRIP YANG DISIMPLIFIKASI
      Hanya logika yang relevan untuk halaman menu yang disimpan.
      - Logika navigasi antar-view dihapus.
      - Logika untuk handleGeneration, import file, copy, dll. dihapus.
    */

    // --- Logika untuk mengambil dan menampilkan kuota ---
    const fetchAndDisplayUsage = async () => {
        const display = document.getElementById('usage-counter-display');
        try {
            // Pastikan URL ini benar sesuai dengan endpoint API Anda
            const response = await fetch(`${window.location.origin}/api/get-usage-status`);
            if (!response.ok) return;
            const data = await response.json();
            if (data.status === 'free') {
                const countEl = document.getElementById('assistant-remaining-count');
                countEl.textContent = `${data.writing_assistant_remaining}/${data.limits['writing_assistant']}`;
                display.classList.remove('hidden');
            }
        } catch (error) {
            console.error("Gagal mengambil status kuota:", error);
        }
    };
    fetchAndDisplayUsage();

    // --- Fungsi Notifikasi (opsional) ---
    const showNotification = (message, type = 'success') => {
        const container = document.getElementById('notification-container');
        if (!container) return;
        const bgColor = type === 'error' ? 'bg-red-500' : 'bg-green-500';
        const notif = document.createElement('div');
        notif.className = `px-4 py-3 text-white ${bgColor} rounded-lg shadow-lg mb-2 animate-fade-in-out`;
        notif.textContent = message;
        container.appendChild(notif);
        setTimeout(() => { notif.remove(); }, 4000);
    };
    
    // Inisialisasi ikon saat pertama kali load
    lucide.createIcons();
});
</script>
{% endblock %}
